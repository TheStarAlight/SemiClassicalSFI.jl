<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Trajectory Simulation and Phase Methods · eTraj.jl</title><meta name="title" content="Trajectory Simulation and Phase Methods · eTraj.jl"/><meta property="og:title" content="Trajectory Simulation and Phase Methods · eTraj.jl"/><meta property="twitter:title" content="Trajectory Simulation and Phase Methods · eTraj.jl"/><meta name="description" content="Documentation for eTraj.jl."/><meta property="og:description" content="Documentation for eTraj.jl."/><meta property="twitter:description" content="Documentation for eTraj.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">eTraj.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../stepbystep_tutorial/">Step-by-step Tutorial</a></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../theory1_init_cond/">Initial Conditions</a></li><li class="is-active"><a class="tocitem" href>Trajectory Simulation and Phase Methods</a><ul class="internal"><li><a class="tocitem" href="#CTMC"><span>Classical Trajectory Monte Carlo (CTMC)</span></a></li><li><a class="tocitem" href="#QTMC"><span>Quantum Trajectory Monte Carlo (QTMC)</span></a></li><li><a class="tocitem" href="#SCTS"><span>Semiclassical Two-Step (SCTS) Model</span></a></li></ul></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../manual1_lasers/">The <code>Lasers</code> Module</a></li><li><a class="tocitem" href="../manual2_targets/">The <code>Targets</code> Module</a></li><li><a class="tocitem" href="../manual3_sampling_traj_simu/">Sampling &amp; Traj Simulation</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../example_overview/">Overview</a></li><li><a class="tocitem" href="../example1_attoclock/">Attoclock &amp; Initial Condition Methods</a></li><li><a class="tocitem" href="../example2_ShortLP_phase_methods/">Short LP Pulses &amp; Phase Methods</a></li><li><a class="tocitem" href="../example3_bichromatic_pulse/">Bichromatic ω-2ω Pulses</a></li><li><a class="tocitem" href="../example4_WFAT-CTMC/">WFAT-CTMC for Molecules</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Trajectory Simulation and Phase Methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Trajectory Simulation and Phase Methods</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TheStarAlight/eTraj.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="theory_traj_phase"><a class="docs-heading-anchor" href="#theory_traj_phase">Theory: Trajectory Evolution and Quantum Phase</a><a id="theory_traj_phase-1"></a><a class="docs-heading-anchor-permalink" href="#theory_traj_phase" title="Permalink"></a></h1><p>Given the initial conditions, the electrons released from the tunnel exit subsequently evolve classically in the combination of Coulomb and laser fields, following a classical trajectory, and the scheme is named the <em>Classical Trajectory Monte Carlo (CTMC)</em>. In addition to the position and momentum, a quantum phase can be attributed to the evolving trajectories within frameworks such as the <em>Quantum Trajectory Monte Carlo (QTMC)</em> and <em>Semiclassical Two-Step (SCTS) Model</em>. These models significantly preserve quantum effects in the final PMD, in contrast to the purely classical CTMC.</p><p>In this section we review the scheme of trajectory evolution and introduce the quantum phase methods available in <code>eTraj</code>.</p><ul><li><a href="#theory_traj_phase">Theory: Trajectory Evolution and Quantum Phase</a></li><li class="no-marker"><ul><li><a href="#CTMC">Classical Trajectory Monte Carlo (CTMC)</a></li><li><a href="#QTMC">Quantum Trajectory Monte Carlo (QTMC)</a></li><li><a href="#SCTS">Semiclassical Two-Step (SCTS) Model</a></li></ul></li></ul><hr/><h2 id="CTMC"><a class="docs-heading-anchor" href="#CTMC">Classical Trajectory Monte Carlo (CTMC)</a><a id="CTMC-1"></a><a class="docs-heading-anchor-permalink" href="#CTMC" title="Permalink"></a></h2><p>Within the CTMC framework, each electron, carrying an associated probability <span>$W$</span>, evolves along a classical trajectory until reaching a final momentum <span>$\pp_\infty = \pp\rvert_{t=\infty}$</span>, which constitutes the primary observable of interest.</p><p>The electrons, emerging from the tunnel with distinct ionization times, initial positions, and momenta, evolve according to Hamilton&#39;s equations:</p><p class="math-container">\[\begin{equation}
    \dot{\rr} = \bm{\nabla}_{\pp} H, \quad \dot{\pp} = - \bm{\nabla}_{\rr} H,
\end{equation}\]</p><p>and we use the Hamiltonian under the LG.</p><p>After the termination of the laser pulse, the electron interacts solely with the residual parent ion. At a distance from the parent ion, the electron experiences the Coulomb tail of the potential, and its Runge-Lenz vector</p><p class="math-container">\[\begin{equation}
    \aa = \pp \times \LL - Z\rr/r
\end{equation}\]</p><p>can be considered asymptotically conserved. By leveraging the conservation of <span>$\aa$</span> alongside the angular momentum and energy, we derive the expression for the final momentum <sup class="footnote-reference"><a id="citeref-ShvetsovShilovski_2012" href="#footnote-ShvetsovShilovski_2012">[ShvetsovShilovski_2012]</a></sup>:</p><p class="math-container">\[\begin{equation}
\begin{aligned}
    \pp_\infty      &amp;= p_\infty \frac{p_\infty (\LL\times\aa)-\aa}{1+p_\infty^2 L^2}, \\
    p_\infty^2/2    &amp;= p^2/2 - Z/r, \\
    \LL             &amp;= \rr\times\pp, \\
    \aa             &amp;= \pp\times\LL - Z\rr/r,
\end{aligned}
\end{equation}\]</p><p>where <span>$\rr$</span> and <span>$\pp$</span> represent the electron&#39;s coordinates at any time subsequent to the termination of the laser pulse. This scheme applies to electrons with positive energy, which are capable of ultimately escaping the parent ion and being detected. Electrons with negative energy are presumed to be captured into Rydberg orbitals.</p><p>Electrons exhibiting comparable final momenta, i.e., those residing within the same bin of the final momentum grid, are aggregated by summing their respective probabilities: <span>$W_{\pp} = \sum_i W_{i}$</span>. This aggregation results in the final momentum spectrum denoted by <span>$W_{\pp}$</span>.</p><hr/><h2 id="QTMC"><a class="docs-heading-anchor" href="#QTMC">Quantum Trajectory Monte Carlo (QTMC)</a><a id="QTMC-1"></a><a class="docs-heading-anchor-permalink" href="#QTMC" title="Permalink"></a></h2><p>In contrast to the CTMC, the QTMC incorporates a quantum phase into each electron trajectory by employing the Feynman path-integral formalism <sup class="footnote-reference"><a id="citeref-Li_2014" href="#footnote-Li_2014">[Li_2014]</a></sup>. This quantum phase is equivalent to the action <span>$S_{\rm{traj}}$</span> defined in Eq. (7) in <a href="../theory1_init_cond/#SFA">SFA</a>, with due consideration of the Coulomb potential. The phase gets accumulated during the electron&#39;s excursion and is expressed as</p><p class="math-container">\[\begin{equation}
    \Phi^{\rm{QTMC}} = S_{\rm{traj}} = - \int_{\tr}^{\infty} \left[ \frac{k^2}{2} + V(\rr) + \Ip \right] \dd t,
\end{equation}\]</p><p>where <span>$\tr$</span> signifies the instant when the electron exits the tunnel, and <span>$\kk=\dot{\rr}$</span> represents the momentum. Ultimately, the PMD is determined by coherently summing the probability amplitudes corresponding to identical final momenta and taking the squared modulus of the resultant sum:</p><p class="math-container">\[\begin{equation}
    W_{\pp} = \abs{\sum_i \sqrt{W_{i}} \ee^{\ii \tilde{S}_i}}^2,
\end{equation}\]</p><p>where <span>$\tilde{S}_i$</span> encompasses the initial phase of the prefactor, the phase accumulated throughout the tunneling process, as well as the trajectory motion:</p><p class="math-container">\[\begin{equation}
    \tilde{S} = \arg \mathcal{P}_{\pp} + \Re S_{\rm{tun}} + S_{\rm{traj}}.
\end{equation}\]</p><p>The phase <span>$\Re S_{\rm{tun}}$</span> can be evaluated numerically but may be simplified if we adhere to the non-adiabatic-expansion scheme outlined in <a href="../theory1_init_cond/#SFAAE">SFA-SPANE</a>:</p><p class="math-container">\[\begin{equation}
\begin{aligned}
    \Re S_{\rm{tun}}
    &amp;\approx \Re \!\! \int_{\ts}^{\tr} \!\!\!\! \dd\tau \left\{ \frac12 \left[ \pp + \AA(\tr) - \ii\ti\FF(\tr) + \frac12 \ti^2 \FF&#39;(\tr)\right]^2 \!\!\! + \Ip \right\} \\
    &amp;= - [\kk(\tr)\cdot\FF(\tr)] \frac{\ti^2}{2} + o(\ti^2) \\
    &amp;\approx -\kk_0\cdot\rr_0.
\end{aligned}
\end{equation}\]</p><p>The last line of Eq. (7), i.e., <span>$-\kk_0\cdot\rr_0$</span>, vanishes for the SFA-SPANE and ADK initial condition methods due to vanishing longitudinal initial momentum (<span>$k_\parallel = 0$</span>).</p><p>It is also noteworthy that in practical implementation, the upper limit of the integral in Eq. (4) need not extend to infinity. Since electrons arriving at the same final momentum share the same energy after the laser vanishes (at <span>$\tf$</span>), the integral</p><p class="math-container">\[\begin{equation}
    \int_{\tf}^{\infty} \left[ \frac{k^2}{2} + V(\rr) + \Ip \right] \dd t
\end{equation}\]</p><p>is uniform for electrons with the same final momentum. Consequently, in numerical implementations, the upper limit of the phase integral in Eq. (4) can be set as the end of the laser pulse, i.e., <span>$\tf$</span>, leading to</p><p class="math-container">\[\begin{equation}
    S^{\rm{QTMC}}_{\rm{traj}} = - \int_{\tr}^{\tf} \left[ \frac{k^2}{2} + V(\rr) + \Ip \right] \dd t.
\end{equation}\]</p><hr/><h2 id="SCTS"><a class="docs-heading-anchor" href="#SCTS">Semiclassical Two-Step (SCTS) Model</a><a id="SCTS-1"></a><a class="docs-heading-anchor-permalink" href="#SCTS" title="Permalink"></a></h2><p>The SCTS model <sup class="footnote-reference"><a id="citeref-ShvetsovShilovski_2016" href="#footnote-ShvetsovShilovski_2016">[ShvetsovShilovski_2016]</a></sup> improves the quantum phase in the QTMC scheme, giving</p><p class="math-container">\[\begin{equation}
    \Phi^{\rm{SCTS}} = \Re S_{\rm{tun}} + S_{\rm{traj}}
    = \underbrace{-\kk_0\cdot\rr_0}_{\Re S_{\rm{tun}}} \underbrace{- \int_{t_0}^\infty \left[ \frac{k^2}{2} + V(\rr) - \rr\cdot\bm{\nabla}V(\rr) + \Ip \right] \dd t}_{S_{\rm{traj}}}.
\end{equation}\]</p><p>Compared to the QTMC phase given by Eq. (4), the SCTS phase from Eq. (10) differs in two key aspects: Firstly, there is the initial phase <span>$-\kk_0\cdot\rr_0$</span>, which results from the tunneling process and is non-zero for non-adiabatic tunneling where <span>$k_{\parallel} \neq 0$</span>. Secondly, the integrand includes the <span>$\rr\cdot\bm{\nabla} V(\rr)$</span> term, which is absent in the QTMC formulation. These differences stem from the distinct theoretical foundations of the two methods; the QTMC phase is derived within the framework of first-order perturbation theory, whereas the SCTS formulation extends beyond this approximation. It should be noted that only the trajectory phase component of the SCTS model, represented by <span>$S_{\rm{traj}}$</span> in Eq. (10), is adopted here. The tunneling phase <span>$\Re S_{\rm{tun}}$</span> is intended to be incorporated during the preparation of initial conditions.</p><p>For the SCTS model, the phase integral in Eq. (10) over the interval <span>$[\tf, \infty)$</span> cannot be simply neglected due to the presence of the <span>$\rr\cdot\bm{\nabla}V(\rr)$</span> term. However, the integral of this term can be reduced to an analytical expression in case of Coulomb potential, called the post-pulse Coulomb phase:</p><p class="math-container">\[\begin{equation}
\begin{aligned}
    S_{\rm{traj,f}}^{\rm{C}}(\tf)
    &amp;= \int_{\tf}^{\infty} \rr\cdot\bm{\nabla} V(\rr) \dd t \\
    &amp;= Z \int_{\tf}^{\infty} \frac{\dd t}{r} \\
    &amp;= - \frac{Z}{p_\infty} \left[ \ln{g} + \sinh^{-1}\left( \frac{p_\infty}{g}\rr_{\rm{f}}\cdot\pp_{\rm{f}} \right) \right],
\end{aligned}
\end{equation}\]</p><p>where <span>$\rr_{\rm{f}}=\rr(\tf)$</span>, <span>$\pp_{\rm{f}}=\pp(\tf)$</span> and <span>$g=\sqrt{1+ p_\infty^2 L^2}=\sqrt{1+p_\infty^2 (\rr_{\rm{f}}\times\pp_{\rm{f}})^2}$</span>.</p><p>In this manner, we derive the expression for the SCTS trajectory phase suitable for numerical implementation:</p><p class="math-container">\[\begin{equation}
\begin{aligned}
    S^{\rm{SCTS}}_{\rm{traj}}
    = \Ip \tr - \int_{\tr}^{\tf} \left[ \frac{k^2}{2} + V(\rr) - \rr\cdot\bm{\nabla}V(\rr) \right] \dd t + S_{\rm{traj,f}}^{\rm{C}}(\tf).
\end{aligned}
\end{equation}\]</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-ShvetsovShilovski_2012"><a class="tag is-link" href="#citeref-ShvetsovShilovski_2012">ShvetsovShilovski_2012</a>N. I. Shvetsov-Shilovski, D. Dimitrovski, and L. B. Madsen, Ionization in elliptically polarized pulses: Multielectron polarization effects and asymmetry of photoelectron momentum distributions, <em>Phys. Rev. A</em> <strong>85</strong>, 023428 (2012). DOI: <a href="https://doi.org/10.1103/PhysRevA.85.023428">10.1103/PhysRevA.85.023428</a>.</li><li class="footnote" id="footnote-Li_2014"><a class="tag is-link" href="#citeref-Li_2014">Li_2014</a>M. Li, J.-W. Geng, H. Liu, Y. Deng, C. Wu, L.-Y. Peng, Q. Gong, and Y. Liu, Classical-quantum correspondence for above-threshold ionization, <em>Phys. Rev. Lett.</em> <strong>112</strong>, 113002 (2014). DOI: <a href="https://doi.org/10.1103/PhysRevLett.112.113002">10.1103/PhysRevLett.112.113002</a></li><li class="footnote" id="footnote-ShvetsovShilovski_2016"><a class="tag is-link" href="#citeref-ShvetsovShilovski_2016">ShvetsovShilovski_2016</a>N. I. Shvetsov-Shilovski, M. Lein, L. B. Madsen, E. Räsänen, C. Lemell, J. Burgdörfer, D. G. Arbó, and K. Tőkési, Semiclassical two-step model for strong-field ionization, <em>Phys. Rev. A</em> <strong>94</strong>, 013415 (2016). DOI: <a href="https://dx.doi.org/10.1103/PhysRevA.94.013415">10.1103/PhysRevA.94.013415</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../theory1_init_cond/">« Initial Conditions</a><a class="docs-footer-nextpage" href="../manual1_lasers/">The <code>Lasers</code> Module »</a><div class="flexbox-break"></div><p class="footer-message">· <em>eTraj.jl</em> Documentation · by <em>Mingyu Zhu</em> and other contributors</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 21 February 2025 17:11">Friday 21 February 2025</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
